<!doctype html>
<html lang="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>La nÃ©gation â€“ Chapitre 4</title>

  <style>
    :root{
      --bg:#0b1020;
      --card:#121a33;
      --card2:#0f1630;
      --text:#e9ecff;
      --muted:#b7c0ff;
      --accent:#8b7bff;
      --good:#47d18c;
      --bad:#ff5c7a;
      --line:rgba(255,255,255,.12);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(1200px 700px at 30% 0%, rgba(139,123,255,.25), transparent 60%),
        radial-gradient(900px 600px at 80% 20%, rgba(71,209,140,.18), transparent 55%),
        var(--bg);
      color:var(--text);
    }
    .container{max-width:980px;margin:0 auto;padding:18px 16px 60px}
    a{color:inherit;text-decoration:none}
    h1{margin:18px 0 8px; font-size:2rem}
    .subtitle{color:var(--muted); margin:0 0 16px}

    .topbar{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; padding:10px 12px;
      border:1px solid var(--line);
      background:rgba(18,26,51,.7);
      backdrop-filter: blur(10px);
      border-radius:16px;
      box-shadow: var(--shadow);
      position: sticky; top: 10px; z-index: 20;
    }
    .topbar .left, .topbar .right{display:flex; align-items:center; gap:10px; flex-wrap:wrap}
    .pill{
      border:1px solid var(--line);
      background:rgba(15,22,48,.8);
      padding:6px 10px;
      border-radius:999px;
      font-weight:650;
      display:inline-flex; align-items:center; gap:8px;
    }
    .small{font-size:.92rem;color:var(--muted)}
    .grid{display:grid; gap:14px}
    .card{
      background: linear-gradient(180deg, rgba(18,26,51,.95), rgba(15,22,48,.95));
      border:1px solid var(--line);
      border-radius:18px;
      padding:14px;
      box-shadow: var(--shadow);
    }
    .card h2{margin:0 0 10px; font-size:1.2rem}
    hr.sep{border:none;border-top:1px dashed var(--line);margin:14px 0}

    .btn{
      cursor:pointer;
      border:none;
      background: linear-gradient(180deg, rgba(139,123,255,1), rgba(108,94,255,1));
      color:white;
      padding:10px 12px;
      border-radius:12px;
      font-weight:800;
    }
    .btn.secondary{
      background: rgba(255,255,255,.08);
      border:1px solid var(--line);
    }
    .btn:active{transform: translateY(1px)}
    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center}

    .badge{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px;
      border-radius:14px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
    }
    .good{color:var(--good); font-weight:900}
    .bad{color:var(--bad); font-weight:900}

    .progressWrap{min-width:210px}
    .progressLabel{display:flex; justify-content:space-between; font-size:.9rem; color:var(--muted); margin-bottom:6px}
    .progressBar{
      height:10px; border-radius:999px; background: rgba(255,255,255,.10);
      border:1px solid var(--line); overflow:hidden;
    }
    .progressFill{height:100%; width:0%; background: linear-gradient(90deg, var(--good), var(--accent))}
    .feedback{
      margin-top:10px; padding:10px 12px; border-radius:14px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
    }
    .kbd{font-family: ui-monospace, SFMono-Regular, Menlo, monospace; background:rgba(0,0,0,.25); padding:2px 6px; border-radius:8px; border:1px solid var(--line)}
    .choice{
      width:100%;
      text-align:left;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      cursor:pointer;
      font-weight:750;
    }
    .choice:hover{background: rgba(255,255,255,.09)}
    .footerNav{display:flex; justify-content:space-between; gap:10px; margin-top:16px; flex-wrap:wrap}

    .sparkle{
      display:inline-block;
      animation: pop .6s ease;
    }
    @keyframes pop{
      0%{transform: scale(.85); opacity:.4}
      100%{transform: scale(1); opacity:1}
    }
    .input{
      flex:1;min-width:240px;padding:10px 12px;border-radius:12px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
      color:var(--text);
      outline:none;
    }
  </style>
</head>

<body>
  <div class="container">

    <!-- TOPPBAR (fremdrift Ã¸verst til hÃ¸yre + XP) -->
    <div class="topbar">
      <div class="left">
        <a class="pill" href="index.html">â† Til meny</a>
        <span class="pill">Salut 9 Â· Kapittel 4</span>
        <span class="pill">â­ XP: <span id="xp">0</span></span>
      </div>

      <div class="right">
        <span class="pill" id="badge">ğŸ¥‰ NÃ©gation Starter</span>
        <div class="progressWrap">
          <div class="progressLabel">
            <span>Fremdrift</span>
            <strong id="pct">0%</strong>
          </div>
          <div class="progressBar"><div class="progressFill" id="fill"></div></div>
        </div>
      </div>
    </div>

    <h1>ğŸš« La nÃ©gation: <span class="kbd">ne</span> â€¦ <span class="kbd">pas</span></h1>
    <p class="subtitle">Svar pÃ¥ oppgaver, samle XP og lÃ¥s opp badges. ğŸ</p>

    <!-- Modulknapper (tilpass hvis du vil) -->
    <div class="row" style="margin:10px 0 6px;">
      <a class="pill" href="meteo.html">â˜€ï¸ MÃ©tÃ©o</a>
      <a class="pill" href="passecompose.html">â³ PassÃ© composÃ©</a>
      <a class="pill" href="vetements.html">ğŸ‘• VÃªtements</a>
      <a class="pill" href="defi.html">ğŸ DÃ©fi</a>
    </div>

    <div class="grid">

      <section class="card">
        <h2>1) Mini-regel ğŸ§©</h2>
        <div class="small">
          Hovedregel: <span class="kbd">ne</span> + VERB + <span class="kbd">pas</span><br>
          PassÃ© composÃ©: negasjonen stÃ¥r rundt hjelpeverbet (<span class="kbd">avoir/Ãªtre</span>)<br>
          <span class="kbd">nâ€™</span> foran vokal / h: <span class="kbd">je nâ€™ai pas</span>, <span class="kbd">il nâ€™habite pas</span>
        </div>
        <hr class="sep">
        <div class="badge">âœ… Eksempel: Je regarde Netflix. â†’ <strong>Je ne regarde pas Netflix.</strong></div>
        <div class="badge">âœ… PC: Jâ€™ai visitÃ© Paris. â†’ <strong>Je nâ€™ai pas visitÃ© Paris.</strong></div>
      </section>

      <section class="card">
        <h2>2) Negasjons-quiz ğŸ¯ (12 oppgaver)</h2>
        <div class="row">
          <span class="pill">Poeng: <strong id="score">0</strong> / <span id="total">0</span></span>
          <button class="btn secondary" id="reset">Nullstill</button>
          <button class="btn" id="next">Ny oppgave âœ</button>
        </div>

        <div class="feedback" id="quizBox">
          <div class="small">Oppgave:</div>
          <div style="font-size:1.1rem; font-weight:900; margin:6px 0 8px;" id="prompt">â€”</div>
          <div class="small" id="question">â€”</div>
          <div class="grid" style="margin-top:10px" id="choices"></div>
          <div class="feedback" id="result" style="margin-top:12px">Svar og fÃ¥ XP! âœ¨</div>
        </div>
      </section>

      <section class="card">
        <h2>3) Bygg setning ğŸ› ï¸</h2>
        <p class="small">Skriv en kort setning og trykk â€œLag neâ€¦pasâ€. (Dette er en enkel â€œhjelperâ€, ikke perfekt grammatikk.)</p>
        <div class="row">
          <input id="pos" class="input" placeholder="Ex: Je mange une pizza." />
          <button class="btn" id="makeNeg">Lag neâ€¦pas âœ¨</button>
          <button class="btn secondary" id="example">Sett inn eksempel</button>
        </div>
        <div class="feedback" id="negOut">Din negasjon dukker opp her ğŸ™‚</div>
      </section>

      <section class="card">
        <h2>4) Bonus-belÃ¸nning ğŸ</h2>
        <p class="small">Skriv 6â€“10 setninger: â€œHva gjorde du ikke?â€. Minst 2 i passÃ© composÃ©.</p>
        <div class="badge">ğŸ’¡ Start: Pendant les vacances, je nâ€™ai pas â€¦ / Je ne suis pas allÃ©(e) Ã  â€¦</div>
        <div class="badge">ğŸ… Bonus: 20 XP hvis du skriver 10+ setninger og varierer tid!</div>
        <div class="row" style="margin-top:10px;">
          <button class="btn secondary" id="bonus20">Jeg har skrevet 10+ setninger âœ… (+20 XP)</button>
        </div>
      </section>

    </div>

    <div class="footerNav">
      <a class="pill" href="meteo.html">â† La mÃ©tÃ©o</a>
      <a class="pill" href="defi.html">Neste: DÃ©fi final â†’</a>
    </div>

  </div>

  <script>
    // ---------- LAGRING (XP + fremdrift) ----------
    const LS_KEY = "chap4_progress_v1";
    function loadState(){
      try{
        return JSON.parse(localStorage.getItem(LS_KEY)) || { xp:0, done:{} };
      }catch(e){
        return { xp:0, done:{} };
      }
    }
    function saveState(s){ localStorage.setItem(LS_KEY, JSON.stringify(s)); }
    function addXP(amount){
      state.xp = Math.max(0, (state.xp||0) + amount);
      saveState(state);
      renderHeader();
    }
    function markDone(id){
      state.done = state.done || {};
      state.done[id] = true;
      saveState(state);
      renderHeader();
    }
    function calcProgress(ids){
      const done = state.done || {};
      const total = ids.length;
      const doneCount = ids.filter(id => done[id]).length;
      const pct = total ? Math.round((doneCount/total)*100) : 0;
      return { pct, doneCount, total };
    }

    // ---------- OPPGAVER (minst 10) ----------
    const QUIZ = [
      { prompt:"ğŸ¬ Je regarde Netflix.", question:"Velg riktig negasjon:", choices:[
        "Je ne regarde pas Netflix.", "Je nâ€™ regarde pas Netflix.", "Je ne pas regarde Netflix."
      ], answer:0 },

      { prompt:"ğŸ• Je mange une pizza.", question:"Velg riktig negasjon:", choices:[
        "Je ne mange pas une pizza.", "Je ne pas mange une pizza.", "Je nâ€™ mange pas une pizza."
      ], answer:0 },

      { prompt:"ğŸ–ï¸ Je vais Ã  la plage.", question:"Velg riktig negasjon:", choices:[
        "Je ne vais pas Ã  la plage.", "Je nâ€™vais pas Ã  la plage.", "Je ne pas vais Ã  la plage."
      ], answer:0 },

      { prompt:"ğŸ§ Jâ€™Ã©coute de la musique.", question:"Velg riktig negasjon (nâ€™ foran vokal):", choices:[
        "Je ne Ã©coute pas de la musique.", "Je nâ€™Ã©coute pas de la musique.", "Je nâ€™ Ã©coute pas de la musique."
      ], answer:1 },

      { prompt:"ğŸ« Il habite Ã  Oslo.", question:"Velg riktig negasjon (nâ€™ foran h):", choices:[
        "Il nâ€™habite pas Ã  Oslo.", "Il ne habite pas Ã  Oslo.", "Il nâ€™ habite pas Ã  Oslo."
      ], answer:0 },

      { prompt:"ğŸ§³ Nous visitons Paris.", question:"Velg riktig negasjon:", choices:[
        "Nous ne visitons pas Paris.", "Nous nâ€™visitons pas Paris.", "Nous ne pas visitons Paris."
      ], answer:0 },

      { prompt:"ğŸ¦ Tu aimes les glaces.", question:"Velg riktig negasjon:", choices:[
        "Tu nâ€™aimes pas les glaces.", "Tu ne aimes pas les glaces.", "Tu nâ€™ aimes pas les glaces."
      ], answer:0 },

      { prompt:"âš½ Ils jouent au foot.", question:"Velg riktig negasjon:", choices:[
        "Ils ne jouent pas au foot.", "Ils ne pas jouent au foot.", "Ils nâ€™jouent pas au foot."
      ], answer:0 },

      // PassÃ© composÃ© (ne ... pas rundt hjelpeverbet)
      { prompt:"ğŸ—¼ Jâ€™ai visitÃ© Paris.", question:"Velg riktig negasjon i passÃ© composÃ©:", choices:[
        "Je nâ€™ai pas visitÃ© Paris.", "Je nâ€™ai visitÃ© pas Paris.", "Je ne ai pas visitÃ© Paris."
      ], answer:0 },

      { prompt:"ğŸš¶ Je suis allÃ©(e) au cinÃ©ma.", question:"Velg riktig negasjon i passÃ© composÃ©:", choices:[
        "Je ne suis pas allÃ©(e) au cinÃ©ma.", "Je suis ne pas allÃ©(e) au cinÃ©ma.", "Je ne suis allÃ©(e) pas au cinÃ©ma."
      ], answer:0 },

      { prompt:"ğŸ° Nous avons mangÃ© un gÃ¢teau.", question:"Velg riktig negasjon i passÃ© composÃ©:", choices:[
        "Nous nâ€™avons pas mangÃ© un gÃ¢teau.", "Nous nâ€™avons mangÃ© pas un gÃ¢teau.", "Nous ne avons pas mangÃ© un gÃ¢teau."
      ], answer:0 },

      { prompt:"ğŸ® Vous jouez aux jeux vidÃ©o.", question:"Velg riktig negasjon:", choices:[
        "Vous ne jouez pas aux jeux vidÃ©o.", "Vous nâ€™ jouez pas aux jeux vidÃ©o.", "Vous ne pas jouez aux jeux vidÃ©o."
      ], answer:0 },
    ];

    // Fremdrift knyttet til 3 ting: sett siden Ã¥pnet, tatt quiz, brukt setningsbygger, bonus
    const TASKS = ["neg_rule","neg_quiz","neg_build","neg_bonus"];

    // ---------- UI refs ----------
    const xpEl = document.getElementById("xp");
    const badgeEl = document.getElementById("badge");
    const pctEl = document.getElementById("pct");
    const fillEl = document.getElementById("fill");

    const totalEl = document.getElementById("total");
    const scoreEl = document.getElementById("score");
    const promptEl = document.getElementById("prompt");
    const questionEl = document.getElementById("question");
    const choicesEl = document.getElementById("choices");
    const resultEl = document.getElementById("result");

    const btnNext = document.getElementById("next");
    const btnReset = document.getElementById("reset");

    const posEl = document.getElementById("pos");
    const negOutEl = document.getElementById("negOut");
    const makeNegBtn = document.getElementById("makeNeg");
    const exampleBtn = document.getElementById("example");
    const bonusBtn = document.getElementById("bonus20");

    // ---------- state ----------
    let state = loadState();
    let score = 0;
    let idx = 0;

    function renderHeader(){
      xpEl.textContent = state.xp || 0;

      const xp = state.xp || 0;
      if(xp >= 120) badgeEl.textContent = "ğŸ† NÃ©gation LÃ©gende";
      else if(xp >= 80) badgeEl.textContent = "ğŸ¥‡ NÃ©gation Ninja";
      else if(xp >= 40) badgeEl.textContent = "ğŸ¥ˆ NÃ©gation Pro";
      else badgeEl.textContent = "ğŸ¥‰ NÃ©gation Starter";

      const { pct } = calcProgress(TASKS);
      pctEl.textContent = pct + "%";
      fillEl.style.width = pct + "%";
    }

    function flash(el, html, kind){
      el.innerHTML = html;
      el.style.borderColor =
        kind === "good" ? "rgba(71,209,140,.7)" :
        kind === "bad"  ? "rgba(255,92,122,.7)" :
        "rgba(255,255,255,.18)";
    }

    // ---------- quiz ----------
    totalEl.textContent = QUIZ.length;

    function pick(i){
      idx = (i + QUIZ.length) % QUIZ.length;
      const q = QUIZ[idx];
      promptEl.textContent = q.prompt;
      questionEl.textContent = q.question;
      choicesEl.innerHTML = "";
      q.choices.forEach((c, ci) => {
        const b = document.createElement("button");
        b.className = "choice";
        b.textContent = (ci+1) + ") " + c;
        b.onclick = () => answer(ci);
        choicesEl.appendChild(b);
      });
      flash(resultEl, "Svar og fÃ¥ XP! âœ¨", "info");
    }

    function answer(ci){
      const q = QUIZ[idx];
      if(ci === q.answer){
        score++;
        scoreEl.textContent = score;

        addXP(10);
        markDone("neg_quiz");

        flash(resultEl, `ğŸ‰ Riktig! <span class="sparkle">+10 XP</span>`, "good");
      }else{
        addXP(2); // litt trÃ¸stepoeng
        flash(resultEl, `âŒ Nesten! Riktig er: <strong>${q.choices[q.answer]}</strong> <span class="sparkle">(+2 XP)</span>`, "bad");
      }
    }

    btnNext.onclick = () => pick(idx + 1);
    btnReset.onclick = () => { score = 0; scoreEl.textContent = "0"; pick(0); };

    // ---------- setningsbygger (enkel) ----------
    function toNeg(s){
      let t = (s || "").trim();
      if(!t) return "";

      // enkel heuristikk: sett ne/n' fÃ¸r ord 2, pas etter ord 2 (nÃ¥ ord 3)
      const words = t.replace(/\s+/g," ").split(" ");
      if(words.length < 2) return t;

      const verb = words[1];
      const startsVowel = /^[aeiouhÃ¢Ã Ã¤Ã©Ã¨ÃªÃ«Ã®Ã¯Ã´Ã¶Ã¹Ã»Ã¼Å“]/i.test(verb);
      const neg = startsVowel ? "nâ€™" : "ne";

      words.splice(1, 0, neg);
      words.splice(3, 0, "pas");

      // rydde litt
      return words.join(" ").replace("nâ€™ ", "nâ€™");
    }

    makeNegBtn.onclick = () => {
      const out = toNeg(posEl.value);
      if(!out){
        flash(negOutEl, "Skriv en setning fÃ¸rst ğŸ™‚", "info");
        return;
      }
      flash(negOutEl, `âœ¨ Negasjon: <strong>${out}</strong> <span class="sparkle">(+5 XP)</span>`, "good");
      addXP(5);
      markDone("neg_build");
    };

    exampleBtn.onclick = () => {
      posEl.value = "Jâ€™ai visitÃ© Paris.";
      flash(negOutEl, "Trykk Â«Lag neâ€¦pasÂ» ğŸ™‚", "info");
    };

    bonusBtn.onclick = () => {
      if(state.done && state.done["neg_bonus"]){
        flash(bonusBtn, "Allerede tatt! ğŸ‰", "good");
        return;
      }
      addXP(20);
      markDone("neg_bonus");
      bonusBtn.textContent = "Bonus tatt! ğŸ‰ (+20 XP)";
    };

    // markÃ©r at regelen er â€œlestâ€
    setTimeout(() => {
      markDone("neg_rule");
    }, 900);

    // init
    renderHeader();
    pick(0);
  </script>
</body>
</html>
